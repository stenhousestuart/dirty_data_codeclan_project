---
title: "Candy Analysis"
output: html_notebook
---

## Q1.
What is the total number of candy ratings given across the three years. 
Number of candy ratings, not the number of raters. Donâ€™t count missing values

```{r}

candy_joined %>% 
  filter(response != is(NA)) %>% 
  summarise(total_ratings = n())

```

## Q2.
What was the average age of people who are going out trick or treating?

```{r}

candy_joined %>%
  filter(going_out == "Yes") %>%
  distinct(response_id, .keep_all = TRUE) %>% 
  summarise(avg_age = round(mean(age, na.rm = TRUE), 0))

```


## Q3.
What was the average age of people who are not going trick or treating?

```{r}

candy_joined %>%
  filter(going_out == "No") %>%
  distinct(response_id, .keep_all = TRUE) %>% 
  summarise(avg_age = round(mean(age, na.rm = TRUE), 0))

```

## Q4.
For each of joy, despair and meh, which candy bar received the most of these 
ratings?

```{r}

candy_joined %>% 
  filter(response == "JOY") %>% 
  count(candy_type, sort = TRUE) %>% 
  head(1)

```

```{r}

candy_joined %>% 
  filter(response == "MEH") %>% 
  count(candy_type, sort = TRUE) %>% 
  head(1)

```

```{r}

candy_joined %>% 
  filter(response == "DESPAIR") %>% 
  count(candy_type, sort = TRUE) %>% 
  head(1)

```


## Q5.
How many people rated Starburst as despair?

```{r}

candy_joined %>% 
  filter(candy_type == "starburst" & response == "DESPAIR") %>%
  summarise(num_starburst_despair = n())
  
```

#### Count despair as -1, joy as +1, and meh as 0.

## Q6.
What was the most popular candy bar by this rating system for each gender 
in the dataset ?

```{r}

# Add Score Column

candy_joined_score <- candy_joined %>%
  mutate(score = case_when(
    response == "JOY" ~ 1,
    response == "MEH" ~ 0,
    response == "DESPAIR" ~ -1
  )
)

# Calculate for Males

candy_joined_score %>% 
  filter(gender == "Male") %>% 
  group_by(candy_type) %>% 
  summarise(total_score = sum(score, na.rm = TRUE)) %>% 
  arrange(desc(total_score)) %>% 
  head(1)


```

```{r}

# Calculate for Females

candy_joined_score %>% 
  filter(gender == "Female") %>% 
  group_by(candy_type) %>% 
  summarise(total_score = sum(score, na.rm = TRUE)) %>% 
  arrange(desc(total_score)) %>% 
  head(1)

```

## Q7.
What was the most popular candy bar in each year?

```{r}

# 2015

candy_joined_score %>%
  filter(year == 2015) %>% 
  group_by(candy_type) %>%  
  summarise(total_yearly_score = sum(score, na.rm = TRUE)) %>% 
  arrange(desc(total_yearly_score)) %>% 
  head(1)            

```

```{r}

# 2016

candy_joined_score %>%
  filter(year == 2016) %>% 
  group_by(candy_type) %>%  
  summarise(total_yearly_score = sum(score, na.rm = TRUE)) %>% 
  arrange(desc(total_yearly_score)) %>% 
  head(1)  

```

```{r}

# 2017

candy_joined_score %>%
  filter(year == 2017) %>% 
  group_by(candy_type) %>%  
  summarise(total_yearly_score = sum(score, na.rm = TRUE)) %>% 
  arrange(desc(total_yearly_score)) %>% 
  head(1)  

```

## Q8.
What was the most popular candy bar by this rating for people in US, Canada, 
UK, and all other countries?

```{r}

# United States of America

candy_joined_score %>% 
  filter(country == "United States Of America") %>% 
  group_by(candy_type) %>% 
  summarise(total_score = sum(score, na.rm = TRUE)) %>% 
  arrange(desc(total_score)) %>% 
  head(1)

```


```{r}

# United Kingdom

candy_joined_score %>% 
  filter(country == "United Kingdom") %>% 
  group_by(candy_type) %>% 
  summarise(total_score = sum(score, na.rm = TRUE)) %>% 
  arrange(desc(total_score)) %>% 
  head(1)

```


```{r}

# Canada

candy_joined_score %>% 
  filter(country == "Canada") %>% 
  group_by(candy_type) %>% 
  summarise(total_score = sum(score, na.rm = TRUE)) %>% 
  arrange(desc(total_score)) %>% 
  head(1)

```

```{r}

# All Others (excluding United States of America, United Kingdom & Canada)

```

